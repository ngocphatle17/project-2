import threading
import time
import random

NUM_TELLERS = 3
NUM_CUSTOMERS = 50

bank_open = threading.Event()
safe_semaphore = threading.Semaphore(2)
manager_semaphore = threading.Semaphore(1)
door_semaphore = threading.Semaphore(2)

teller_ready = [threading.Semaphore(0) for _ in range(NUM_TELLERS)]
customer_ready = [threading.Semaphore(0) for _ in range(NUM_CUSTOMERS)]
transaction_ready = [threading.Semaphore(0) for _ in range(NUM_CUSTOMERS)]
transaction_done = [threading.Semaphore(0) for _ in range(NUM_CUSTOMERS)]
customer_left = [threading.Semaphore(0) for _ in range(NUM_CUSTOMERS)]

customer_queue = []
queue_lock = threading.Lock()
teller_available = [True] * NUM_TELLERS
teller_customer_map = [None] * NUM_TELLERS

def log(thread_type, id, target, msg):
    if target is not None:
        print(f"{thread_type} {id} [{target}]: {msg}")
    else:
        print(f"{thread_type} {id} []: {msg}")
